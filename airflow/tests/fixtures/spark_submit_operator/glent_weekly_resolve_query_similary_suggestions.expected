[
    "spark-submit",
    "--master",
    "yarn",
    "--conf",
    "spark.dynamicAllocation.maxExecutors=150",
    "--conf",
    "spark.reducer.maxReqsInFlight=1",
    "--conf",
    "spark.shuffle.io.maxRetries=10",
    "--conf",
    "spark.shuffle.io.retryWait=120s",
    "--conf",
    "spark.sql.executor.memoryOverhead=640M",
    "--conf",
    "spark.sql.shuffle.partitions=2500",
    "--conf",
    "spark.sql.shuffle.service.enabled=true",
    "--conf",
    "spark.yarn.maxAppAttempts=1",
    "--executor-cores",
    "4",
    "--executor-memory",
    "8G",
    "--driver-memory",
    "1G",
    "--name",
    "airflow-spark",
    "--queue",
    "root.default",
    "/path/to/wikimedia/discovery/analytics/repo/artifacts/glent-0.2.2-jar-with-dependencies.jar",
    "m1run",
    "--input-table",
    "glent.m1prep",
    "--input-partition",
    "20380124",
    "--candidates-directory",
    "hdfs://analytics-hadoop/tmp/glent_weekly_2038-01-17/query_similarity_candidates",
    "--max-edit-dist-sugg",
    "3",
    "--max-norm-edit-dist",
    "1.5",
    "--min-hits-diff",
    "100",
    "--min-hits-perc-diff",
    "10",
    "--output-table",
    "glent.suggestions",
    "--output-partition",
    "20380124",
    "--max-output-partitions",
    "100"
]